var He=Object.defineProperty,Re=Object.defineProperties;var Ye=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable;var ie=(e,t,n)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O=(e,t)=>{for(var n in t||(t={}))Xe.call(t,n)&&ie(e,n,t[n]);if(se)for(var n of se(t))ze.call(t,n)&&ie(e,n,t[n]);return e},ue=(e,t)=>Re(e,Ye(t));var oe=(e,t,n)=>new Promise((y,v)=>{var S=k=>{try{p(n.next(k))}catch(E){v(E)}},r=k=>{try{p(n.throw(k))}catch(E){v(E)}},p=k=>k.done?y(k.value):Promise.resolve(k.value).then(S,r);p((n=n.apply(e,t)).next())});import{ao as We,d as _e,f as Te,ag as qe,c as I,w as $,Z as M,_ as U,u as i,N as Ge,ab as m,a8 as J,a9 as j,E as de,a0 as he,a1 as fe,l as L,F as z,aa as Je,ai as Ze,aj as Qe,A as et,m as ye,r as pe,H as X,h as V,o as tt,n as ge,z as ke,ac as nt,i as at}from"./vue-f962b0e4.js";import{a$ as lt,b0 as ct,b1 as rt,b2 as st,b3 as it,b4 as ut,b5 as ot,b6 as Se,b7 as dt,b8 as ht,ag as ft,i as yt,u as pt,a6 as gt,I as Q,p as kt,c as ee,b9 as Ke,R as St,o as Kt,n as Z,ba as xt,az as bt,bb as At,aa as xe,ac as Ct,V as Lt,z as be}from"./index.js";import{av as vt,d as Et,aw as _t,ax as Tt,D as wt,i as Bt,Y as Dt,ah as Ae}from"./antd-2f1e67c0.js";import{u as Ft}from"./useContextMenu-b69faf00.js";import{g as Nt}from"./get-3d19de2f.js";import{i as Ce}from"./isBoolean-9388e2d6.js";var Mt=200;function It(e,t,n,y){var v=-1,S=st,r=!0,p=e.length,k=[],E=t.length;if(!p)return k;n&&(t=lt(t,ct(n))),y?(S=it,r=!1):t.length>=Mt&&(S=ut,r=!1,t=new rt(t));e:for(;++v<p;){var K=e[v],d=n==null?K:n(K);if(K=y||K!==0?K:0,r&&d===d){for(var a=E;a--;)if(t[a]===d)continue e;k.push(K)}else S(t,d,y)||k.push(K)}return k}var Ot=ot(function(e,t){return Se(e)?It(e,dt(t,1,Se,!0)):[]});const mt=Ot;function $t(e){for(var t=-1,n=e==null?0:e.length,y={};++t<n;){var v=e[t];y[v[0]]=v[1]}return y}function te(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((n,y)=>n+te(e,y),""):Object.keys(t).reduce((n,y)=>n+(t[y]?te(e,y):""),""):""}function Pt(e){return(t,n)=>(t&&typeof t!="string"&&(n=t,t=""),t=t?`${e}__${t}`:e,`${t}${te(t,n)}`)}function we(e){return[Pt(`${ht}-${e}`)]}const Le=Symbol(),ve=Symbol();function Ut(e,t){if(!ft(e)||e[ve])return e;const{values:n,required:y,default:v,type:S,validator:r}=e,p=n||r?k=>{let E=!1,K=[];if(n&&(K=[...n,v],E||(E=K.includes(k))),r&&(E||(E=r(k))),!E&&K.length>0){const d=[...new Set(K)].map(a=>JSON.stringify(a)).join(", ");We(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${d}], got value ${JSON.stringify(k)}.`)}return E}:void 0;return{type:typeof S=="object"&&Object.getOwnPropertySymbols(S).includes(Le)&&S?S[Le]:S,required:!!y,default:v,validator:p,[ve]:!0}}const jt=e=>$t(Object.entries(e).map(([t,n])=>[t,Ut(n,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Vt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Ht=jt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),Rt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Yt=_e({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const n=e,y=Te(""),[v]=we("tree-header"),S=qe(),{t:r}=yt(),p=I(()=>["mr-1","w-full",{"ml-5":S.headerTitle||n.title}]),k=I(()=>{const{checkable:a}=n,c=[{label:r("component.tree.expandAll"),value:T.EXPAND_ALL},{label:r("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:a}];return a?[{label:r("component.tree.selectAll"),value:T.SELECT_ALL},{label:r("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:a},...c,{label:r("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:r("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:c}),E=({key:a})=>{var c,s,h,o;switch(a){case T.SELECT_ALL:(c=n.checkAll)==null||c.call(n,!0);break;case T.UN_SELECT_ALL:(s=n.checkAll)==null||s.call(n,!1);break;case T.EXPAND_ALL:(h=n.expandAll)==null||h.call(n,!0);break;case T.UN_EXPAND_ALL:(o=n.expandAll)==null||o.call(n,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}};function K(a){t("search",a)}const d=pt(K,200);return $(()=>y.value,a=>{d(a)}),$(()=>n.searchText,a=>{a!==y.value&&(y.value=a)}),(a,c)=>(M(),U("div",{class:fe([i(v)(),"flex px-2 py-1.5 items-center"])},[i(S).headerTitle?Ge(a.$slots,"headerTitle",{key:0}):m("",!0),!i(S).headerTitle&&a.title?(M(),J(i(gt),{key:1,helpMessage:a.helpMessage},{default:j(()=>[de(he(a.title),1)]),_:1},8,["helpMessage"])):m("",!0),a.search||a.toolbar?(M(),U("div",Rt,[a.search?(M(),U("div",{key:0,class:fe(p.value)},[L(i(vt),{placeholder:i(r)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":c[0]||(c[0]=s=>y.value=s)},null,8,["placeholder","value"])],2)):m("",!0),a.toolbar?(M(),J(i(wt),{key:1,onClick:c[1]||(c[1]=et(()=>{},["prevent"]))},{overlay:j(()=>[L(i(Et),{onClick:E},{default:j(()=>[(M(!0),U(z,null,Je(k.value,s=>(M(),U(z,{key:s.value},[L(i(_t),Ze(Qe({key:s.value})),{default:j(()=>[de(he(s.label),1)]),_:2},1040),s.divider?(M(),J(i(Tt),{key:0})):m("",!0)],64))),128))]),_:1})]),default:j(()=>[L(Q,{icon:"ion:ellipsis-vertical"})]),_:1})):m("",!0)])):m("",!0)],2))}}),Xt=({icon:e})=>e?kt(e)?ye(Q,{icon:e,class:"mr-1"}):ye(Q):null;function zt(e,t){function n(d){const a=[],c=d||i(e),{key:s,children:h}=i(t);if(!h||!s)return a;for(let o=0;o<c.length;o++){const u=c[o];a.push(u[s]);const g=u[h];g&&g.length&&a.push(...n(g))}return a}function y(d){const a=[],c=d||i(e),{key:s,children:h}=i(t);if(!h||!s)return a;for(let o=0;o<c.length;o++){const u=c[o];u.disabled!==!0&&u.selectable!==!1&&a.push(u[s]);const g=u[h];g&&g.length&&a.push(...y(g))}return a}function v(d,a){const c=[],s=a||i(e),{key:h,children:o}=i(t);if(!o||!h)return c;for(let u=0;u<s.length;u++){const g=s[u],_=g[o];d===g[h]?(c.push(g[h]),_&&_.length&&c.push(...n(_))):_&&_.length&&c.push(...v(d,_))}return c}function S(d,a,c){if(!d)return;const s=c||i(e),{key:h,children:o}=i(t);if(!(!o||!h))for(let u=0;u<s.length;u++){const g=s[u],_=g[o];if(g[h]===d){s[u]=O(O({},s[u]),a);break}else _&&_.length&&S(d,a,g[o])}}function r(d=1,a,c=1){if(!d)return[];const s=[],h=a||i(e)||[];for(let o=0;o<h.length;o++){const u=h[o],{key:g,children:_}=i(t),W=g?u[g]:"",P=_?u[_]:[];s.push(W),P&&P.length&&c<d&&(c+=1,s.push(...r(d,P,c)))}return s}function p({parentKey:d=null,node:a,push:c="push"}){const s=ee(i(e));if(!d){s[c](a),e.value=s;return}const{key:h,children:o}=i(t);!o||!h||(Ke(s,u=>{if(u[h]===d)return u[o]=u[o]||[],u[o][c](a),!0}),e.value=s)}function k({parentKey:d=null,list:a,push:c="push"}){const s=ee(i(e));if(!(!a||a.length<1))if(d){const{key:h,children:o}=i(t);if(!o||!h)return;Ke(s,u=>{if(u[h]===d){u[o]=u[o]||[];for(let g=0;g<a.length;g++)u[o][c](a[g]);return e.value=s,!0}})}else{for(let h=0;h<a.length;h++)s[c](a[h]);e.value=s;return}}function E(d,a){if(!d)return;const c=a||i(e),{key:s,children:h}=i(t);if(!(!h||!s))for(let o=0;o<c.length;o++){const u=c[o],g=u[h];if(u[s]===d){c.splice(o,1);break}else g&&g.length&&E(d,u[h])}}function K(d,a,c){if(!d&&d!==0)return null;const s=a||i(e),{key:h,children:o}=i(t);return h?(s.forEach(u=>{if(c!=null&&c.key||(c==null?void 0:c.key)===0)return c;if(u[h]===d){c=u;return}u[o]&&u[o].length&&(c=K(d,u[o],c))}),c||null):null}return{deleteNodeByKey:E,insertNodeByKey:p,insertNodesByKey:k,filterByLevel:r,updateNodeByKey:S,getAllKeys:n,getChildrenKeys:v,getEnabledKeys:y,getSelectedNode:K}}function Ee(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!at(e)}const tn=_e({name:"BasicTree",inheritAttrs:!1,props:Ht,emits:Vt,setup(e,{attrs:t,slots:n,emit:y,expose:v}){const[S]=we("tree"),r=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=pe({startSearch:!1,searchText:"",searchData:[]}),k=Te([]),[E]=Ft(),K=I(()=>{const{fieldNames:l}=e;return O({children:"children",title:"title",key:"key"},l)}),d=I(()=>{let l=ue(O(O({blockNode:!0},t),e),{expandedKeys:r.expandedKeys,selectedKeys:r.selectedKeys,checkedKeys:r.checkedKeys,checkStrictly:r.checkStrictly,fieldNames:i(K),"onUpdate:expandedKeys":f=>{r.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{r.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,b)=>{let x=X(r.checkedKeys);if(St(x)&&p.startSearch){const C=b.node.eventKey;x=mt(x,W(C)),b.checked&&x.push(C),r.checkedKeys=x}else r.checkedKeys=f;const A=X(r.checkedKeys);y("update:value",A),y("check",A,b)},onRightClick:Fe});return Kt(l,"treeData","class")}),a=I(()=>p.startSearch?p.searchData:i(k)),c=I(()=>!a.value||a.value.length===0),{deleteNodeByKey:s,insertNodeByKey:h,insertNodesByKey:o,filterByLevel:u,updateNodeByKey:g,getAllKeys:_,getChildrenKeys:W,getEnabledKeys:P,getSelectedNode:Be}=zt(k,K);function De(l,f){return!f&&e.renderIcon&&Z(e.renderIcon)?e.renderIcon(l):f}function Fe(b){return oe(this,arguments,function*({event:l,node:f}){var F;const{rightMenuList:x=[],beforeRightClick:A}=e;let C={event:l,items:[]};if(A&&Z(A)){let w=yield A(f,l);Array.isArray(w)?C.items=w:Object.assign(C,w)}else C.items=x;(F=C.items)!=null&&F.length&&(C.items=C.items.filter(w=>!w.hidden),E(C))})}function Ne(){return i(k)}function H(l){r.expandedKeys=l}function Me(){return r.expandedKeys}function ne(l){r.selectedKeys=l}function Ie(){return r.selectedKeys}function ae(l){r.checkedKeys=l}function Oe(){return r.checkedKeys}function le(l){r.checkedKeys=l?P():[]}function q(l){r.expandedKeys=l?_():[]}function me(l){r.checkStrictly=l}$(()=>e.searchValue,l=>{l!==p.searchText&&(p.searchText=l)},{immediate:!0}),$(()=>e.treeData,l=>{l&&G(p.searchText)});function G(l){if(l!==p.searchText&&(p.searchText=l),y("update:searchValue",l),!l){p.startSearch=!1;return}const{filterFn:f,checkable:b,expandOnSearch:x,checkOnSearch:A,selectedOnSearch:C}=i(e);p.startSearch=!0;const{title:F,key:w}=i(K),D=[];if(p.searchData=xt(i(k),B=>{var R,Y;const N=f?f(l,B,i(K)):(Y=(R=B[F])==null?void 0:R.includes(l))!=null?Y:!1;return N&&D.push(B[w]),N},i(K)),x){const B=bt(p.searchData).map(N=>N[w]);B&&B.length&&H(B)}A&&b&&D.length&&ae(D),C&&D.length&&ne(D)}function $e(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!r.expandedKeys.includes(l))H([...r.expandedKeys,l]);else{const b=[...r.expandedKeys],x=b.findIndex(A=>A===l);x!==-1&&b.splice(x,1),H(b)}}V(()=>{k.value=e.treeData}),tt(()=>{const l=parseInt(e.defaultExpandLevel);l>0?r.expandedKeys=u(l):e.defaultExpandAll&&q(!0)}),V(()=>{r.expandedKeys=e.expandedKeys}),V(()=>{r.selectedKeys=e.selectedKeys}),V(()=>{r.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{r.checkedKeys=X(e.value||[])},{immediate:!0}),$(()=>r.checkedKeys,()=>{const l=X(r.checkedKeys);y("update:value",l),y("change",l)}),V(()=>{r.checkStrictly=e.checkStrictly});const Pe={getTreeData:Ne,setExpandedKeys:H,getExpandedKeys:Me,setSelectedKeys:ne,getSelectedKeys:Ie,setCheckedKeys:ae,getCheckedKeys:Oe,insertNodeByKey:h,insertNodesByKey:o,deleteNodeByKey:s,updateNodeByKey:g,getSelectedNode:Be,checkAll:le,expandAll:q,filterByLevel:l=>{r.expandedKeys=u(l)},setSearchValue:l=>{G(l)},getSearchValue:()=>p.searchText};function Ue(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((b,x)=>{var C;let A=!0;return Z(b.show)?A=(C=b.show)==null?void 0:C.call(b,l):Ce(b.show)&&(A=b.show),A?L("span",{key:x,class:S("action")},[b.render(l)]):null})}const je=I(()=>{const l=ee(a.value);return At(l,(f,b)=>{var re;const x=p.searchText,{highlight:A}=i(e),{title:C,key:F,children:w}=i(K),D=De(f,f.icon),B=Nt(f,C),N=x?B.indexOf(x):-1,R=p.startSearch&&!Lt(x)&&A&&N!==-1,Y=`color: ${Ce(A)?"#f50":A}`,Ve=R?L("span",{class:(re=i(d))!=null&&re.blockNode?`${S("content")}`:""},[L("span",null,[B.substr(0,N)]),L("span",{style:Y},[x]),L("span",null,[B.substr(N+x.length)])]):B,ce=D?L(Xt,{icon:D},null):n.icon?L("span",{class:"mr-1"},[be(n,"icon")]):null;return f[C]=L("span",{class:`${S("title")} pl-2`,onClick:$e.bind(null,f[F],f[w])},[n!=null&&n.title?L(z,null,[ce,be(n,"title",f)]):L(z,null,[ce,Ve,L("span",{class:S("actions")},[Ue(f)])])]),f}),l});return v(Pe),()=>{let l,f;const{title:b,helpMessage:x,toolbar:A,search:C,checkable:F}=e,w=b||A||C||n.headerTitle,D={height:"calc(100% - 38px)"};return L("div",{class:[S(),"h-full",t.class]},[w&&L(Yt,{checkable:F,checkAll:le,expandAll:q,title:b,search:C,toolbar:A,helpMessage:x,onStrictlyChange:me,onSearch:G,searchText:p.searchText},Ee(l=xe(n))?l:{default:()=>[l]}),L(Bt,{wrapperClassName:i(e.treeWrapperClassName),spinning:i(e.loading),tip:"加载中..."},{default:()=>[ge(L(Ct,{style:D},{default:()=>[L(Dt,nt(i(d),{showIcon:!1,treeData:je.value}),Ee(f=xe(n,["title"]))?f:{default:()=>[f]})]}),[[ke,!i(c)]]),ge(L(Ae,{image:Ae.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ke,i(c)]])]})])}}});export{tn as _};
